{
  "path": "/blog/2019-02-08-government-open-data-site-with-gatsby/",
  "result": {
    "data": {
      "mdx": {
        "body": "function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"How we're migrating a government open data site to Gatsby\",\n  \"date\": \"2019-02-08T00:00:00.000Z\",\n  \"author\": \"Ryan Johnson\",\n  \"tags\": [\"cutting-edge-experiences\", \"data-visualization\", \"case-studies\"],\n  \"canonicalLink\": \"https://revenuedata.doi.gov/blog/homepage-revamp-part-two/\"\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"This post was originally published at \", mdx(\"a\", _extends({\n    parentName: \"em\"\n  }, {\n    \"href\": \"https://revenuedata.doi.gov/blog/\"\n  }), \"Open data design at the U.S. Department of the Interior\"), \".\")), mdx(\"p\", null, \"A few months ago, our small team at the Office of Natural Resources Revenue (ONRR) decided we needed to refactor our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://revenuedata.doi.gov/\"\n  }), \"open-data website\"), \". We knew we were in for a massive undertaking, as the site was originally built with the static-site generator \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://jekyllrb.com/\"\n  }), \"Jekyll\"), \", with significant custom coding to furnish bespoke features, automate data updates, and compile and deploy the site with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://18f.gsa.gov/\"\n  }), \"18F\\u2019s\"), \" fantastic static-site hosting service, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://federalist.18f.gov/\"\n  }), \"Federalist\"), \".\"), mdx(\"p\", null, \"As covered in our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://revenuedata.doi.gov/blog/homepage-revamp/\"\n  }), \"first post in this series\"), \", we were simultaneously scoping a redesign of our homepage. Rebuilding the homepage would allow us to test some of our assumptions about how to address obstacles in our existing workflow.\"), mdx(\"h2\", {\n    \"id\": \"transition-obstacles\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#transition-obstacles\",\n    \"aria-label\": \"transition obstacles permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Transition obstacles\"), mdx(\"p\", null, \"When our team was hired to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://18f.gsa.gov/2018/05/01/lessons-from-an-18f-product-transition/\"\n  }), \"transition the site from 18F\"), \" in late 2017, one issue emerged as an immediate concern. Our team was issued Windows 7 laptops (thankfully, we\\u2019ve since received Windows 10 machines), and we had a problem: the site\\u2019s codebase wasn\\u2019t particularly cross-platform friendly. Jekyll is built with Ruby; the former isn\\u2019t officially supported on Windows, and the latter doesn\\u2019t ship with Windows (as it does with macOS). To complicate matters further, the script to perform the most routine content management on the site \\u2013 update the production, revenue, and disbursements data \\u2013 assumed macOS/Linux output paths (forward slashes). The script broke on Windows.\"), mdx(\"p\", null, \"Of course, we could have refactored just the data-update script, but what we really needed was a way for multiple team members to update the data from their government-issued computers (with limited admin rights). We wanted to create a workflow that would solve some of our biggest content management problems:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"We couldn\\u2019t use our government-issued computers to update the data.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"We didn\\u2019t have one source of truth for the data: we had \", mdx(\"inlineCode\", {\n    parentName: \"li\"\n  }, \".tsv\"), \" data files to update the site visualizations with, and we had Excel files for download, both of which had to be manually maintained.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Updating the data required specific software dependencies (Make, SQLite3, npm), which our data specialists and subject matter experts lacked. Which meant\\u2026\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A developer had to update the data, and we have only one developer on the team.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"The codebase had a significant learning curve for new developers, due to the custom implementation of Jekyll.\")), mdx(\"p\", null, \"At the same time, we didn\\u2019t want to lose momentum on our user-centered design and development process, which we inherited from our colleagues at 18F. A refactored homepage served as an early proof of concept for fully transitioning our codebase, while allowing us to continue adding value for users.\"), mdx(\"p\", null, \"We landed on Gatsby as our choice to refactor the site. The full scope of how and why we chose Gatsby is the subject of another post, but our work on the homepage reveals many of the reasons we decided to move to Gatsby.\"), mdx(\"h2\", {\n    \"id\": \"refactoring-as-we-go\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#refactoring-as-we-go\",\n    \"aria-label\": \"refactoring as we go permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Refactoring as we go\"), mdx(\"p\", null, \"We knew we\\u2019d have to segment our transition to Gatsby into our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://en.wikipedia.org/wiki/Agile_software_development\"\n  }), \"Agile workflow\"), \", which meant we would have a hybrid site for the duration of the transition: part Jekyll, part Gatsby. It would result in some redundancy, with duplicative effort for some updates. But it would allow us to continue to iterate on the site, while incrementally transitioning our codebase. Our biggest goal was to maintain a seamless experience for users, in line with Agile leader \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://martinfowler.com/articles/agile-aus-2018.html\"\n  }), \"Martin Fowler\\u2019s description of refactoring\"), \":\"), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Refactoring is lots of small changes, none of which change the observable part of the software, but all of which change its internal structure. Usually (you refactor) because you want to make some new feature, and the current internal structure doesn\\u2019t fit very well for that new feature. So you change the structure to make the new feature easy to fit in, all the time refactoring and not breaking anything, and then you can put it in.\")), mdx(\"p\", null, \"We\\u2019d transitioned some of our site already: we migrated our \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://revenuedata.doi.gov/explore/\"\n  }), \"explore data page\"), \", which was a heavy lift that proved we could support both workflows simultaneously (the page serves as the data-heavy fulcrum of the site). But in that transition, we\\u2019d left the data-update process largely the same.\"), mdx(\"p\", null, \"The homepage presented an exciting opportunity, as the redesign would feature monthly data for the first time on the site. Up until that point, we\\u2019d published only annual data. The addition of monthly data meant we needed a way to quickly and easily update the data. It became even more important that other team members \\u2013 besides just our developer \\u2013 could update the data.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"786px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/92cbaff36d405cbb806ab5e8e88f39df/974da/full-homepage.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"285.9965635738831%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAA5ABQDASIAAhEBAxEB/8QAGQABAQEBAQEAAAAAAAAAAAAAAAIFAQME/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdup+JNFBalJ6uA4KcGEzFmkzSf/xAAeEAACAQQDAQAAAAAAAAAAAAAAAQIDEBEUEiAhQv/aAAgBAQABBQL6s2KuQeYHFWeTEhdPDy25M3Khu1On/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAwEBPwEP/8QAFBEBAAAAAAAAAAAAAAAAAAAAMP/aAAgBAgEBPwEP/8QAIRAAAQIFBQEAAAAAAAAAAAAAAAExAhARICEiMkJxgaH/2gAIAQEABj8Cfya4z0a4KCLSkmSTm74Zv4jQjQ2f/8QAIBAAAwABAwUBAAAAAAAAAAAAAAERIRAxQSBhcYHx8P/aAAgBAQABPyFzlFQiTio/KXwbkAVhRzScltjRKxHowBaWVZyYu+m7JOwUMKcvwz5LPhvo/9oADAMBAAIAAwAAABDQyzAzyw3/xAAWEQEBAQAAAAAAAAAAAAAAAAABETD/2gAIAQMBAT8QWYf/xAAWEQEBAQAAAAAAAAAAAAAAAAABMDH/2gAIAQIBAT8QUNh//8QAJBABAAIBAQcFAAAAAAAAAAAAAQARITEgQWFxgaHwUZGxwdH/2gAIAQEAAT8QQRm1on5cxrVdICrN8ByEkLZxphHOA13+9MIpkuDcyUrvEtWmQhDJEJAQrSo7kgVRu1CojneOctpNOHMI2VBeJD0F0iBXwSyxK7NLvC2vI5zxD72P/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"homepage design of natural resources revenue data, featuring a map of the U.S., and charts for natural resources production, revenue, and disbursments on federal lands and waters\",\n    \"title\": \"homepage design of natural resources revenue data, featuring a map of the U.S., and charts for natural resources production, revenue, and disbursments on federal lands and waters\",\n    \"src\": \"/static/92cbaff36d405cbb806ab5e8e88f39df/a022f/full-homepage.jpg\",\n    \"srcSet\": [\"/static/92cbaff36d405cbb806ab5e8e88f39df/28bf1/full-homepage.jpg 197w\", \"/static/92cbaff36d405cbb806ab5e8e88f39df/afe26/full-homepage.jpg 393w\", \"/static/92cbaff36d405cbb806ab5e8e88f39df/a022f/full-homepage.jpg 786w\", \"/static/92cbaff36d405cbb806ab5e8e88f39df/974da/full-homepage.jpg 1164w\"],\n    \"sizes\": \"(max-width: 786px) 100vw, 786px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"h2\", {\n    \"id\": \"rebuilding-in-gatsby\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#rebuilding-in-gatsby\",\n    \"aria-label\": \"rebuilding in gatsby permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Rebuilding in Gatsby\"), mdx(\"p\", null, \"Thankfully, Gatsby is open source. Had it not been, we wouldn\\u2019t have considered it. Our team \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/ONRR/doi-extractives-data\"\n  }), \"works in the open, with open data, and open source tools\"), \". We think that model is a good fit for government.\"), mdx(\"p\", null, \"In addition to being open source, there are five main reasons we used Gatsby to refactor the site:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Gatsby is a cross-platform ecosystem out of the box.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://graphql.org/\"\n  }), \"GraphQL\"), \" allows us to query the data from a canonical source, instead of regenerating the data into multiple files to fit a particular context.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Anyone on our team can update the data. Team members need only Excel and GitHub to update the data, and we have one source of truth to maintain for each dataset.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Gatsby is a modern, web-component framework that allows us to design the site in a more modular way, leading to better code reuse.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, \"We\\u2019re better aligned with industry best practices, which supports long-term site maintenance.\"))), mdx(\"p\", null, \"We\\u2019ll look at each of these in the context of our homepage redesign.\"), mdx(\"h3\", {\n    \"id\": \"cross-platform-ready\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#cross-platform-ready\",\n    \"aria-label\": \"cross platform ready permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Cross-platform ready\"), mdx(\"p\", null, \"As mentioned above, our most significant challenge transitioning the codebase from 18F to ONRR was operating system compatibility. We were asking a lot of our IT group, who had to vet our tech stack to ensure it met security requirements. It was a time consuming process that, even when we were granted administrative privileges, still left us with dependency errors and a parallel data-update workflow using separate machines.\"), mdx(\"p\", null, \"Gatsby combines multiple front-end tools into one, and the packages are managed with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.npmjs.com/\"\n  }), \"npm\"), \" or \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://yarnpkg.com/\"\n  }), \"yarn\"), \", so the scope of our IT requests is limited to widely used package managers. From what we can tell so far, running Gatsby is nearly identical regardless of the operating system you\\u2019re using. As we\\u2019ll describe in the next section, we were able to build a data-update workflow that we could support using our government-issued computers.\"), mdx(\"h3\", {\n    \"id\": \"graphql\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#graphql\",\n    \"aria-label\": \"graphql permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"GraphQL\"), mdx(\"p\", null, \"GraphQL has been a game changer for us. Our open data is largely comprised of flat Excel files, but we also access some data via API. Much of our content is formatted in Markdown. GraphQL can query it all in a schema whereby we get exactly the data and content we need for a particular context.\"), mdx(\"p\", null, \"Where before our data-update scripts would generate multiple \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \".yml\"), \" files \\u2013 structured for the specific context in which the data would appear \\u2013 we can now query the data with GraphQL and reference it in whatever context we need. Importantly, we maintain just one canonical data file and structure our query to fetch what we need.\"), mdx(\"p\", null, \"We use the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/packages/gatsby-transformer-excel/\"\n  }), mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"gatsby-transformer-excel\"), \" plugin\"), \" to parse our Excel data and convert it into \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"JSON\"), \" arrays accessible to both GraphQL and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://d3js.org/\"\n  }), \"D3.js\"), \", our data visualization library.\"), mdx(\"p\", null, \"Here\\u2019s a sample GraphQL query from the homepage to fetch revenue data:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-graphql\"\n  }), \"    Revenues:allRevenues (\\n      filter:{RevenueCategory:{ne: null}}\\n      sort:{fields:[RevenueDate], order: DESC}\\n    ) {\\n      revenues:edges {\\n        data:node {\\n          RevenueDate\\n          RevenueMonth:RevenueDate(formatString: \\\"MMMM\\\")\\n          RevenueYear:RevenueDate(formatString: \\\"YYYY\\\")\\n          DisplayYear:RevenueDate(formatString: \\\"'YY\\\")\\n          DisplayMonth:RevenueDate(formatString: \\\"MMM\\\")\\n          Revenue\\n          RevenueCategory\\n        }\\n      }\\n    }\\n\")), mdx(\"p\", null, \"Every member of our team can now update the homepage data, using only Excel and GitHub on their government-issued laptops. Now that we\\u2019re publishing data every month, with a team distributed across multiple time zones, that makes a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"huge\"), \" difference. GraphQL allows us to quickly correct mistakes, ship content updates, and iterate on our data visualizations.\"), mdx(\"p\", null, \"We update the Excel file, and we get our updated charts on build.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"786px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/8216b1a577b24311b6712b7c136c054f/4450c/homepage-revenue-disbursements.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": [\"noopener\"]\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"70.55888223552894%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe8g0g//xAAWEAEBAQAAAAAAAAAAAAAAAAAQEQD/2gAIAQEAAQUCZof/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARUSH/2gAIAQEAAT8hSONxTBLhR//aAAwDAQACAAMAAAAQIw//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABABEhMVFhcZH/2gAIAQEAAT8QQeO4DEWzDTDG8HLR7EmmAMBRP//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Homepage data visualizations showing Revenue and Disbursements\",\n    \"title\": \"Homepage data visualizations showing Revenue and Disbursements\",\n    \"src\": \"/static/8216b1a577b24311b6712b7c136c054f/a022f/homepage-revenue-disbursements.jpg\",\n    \"srcSet\": [\"/static/8216b1a577b24311b6712b7c136c054f/28bf1/homepage-revenue-disbursements.jpg 197w\", \"/static/8216b1a577b24311b6712b7c136c054f/afe26/homepage-revenue-disbursements.jpg 393w\", \"/static/8216b1a577b24311b6712b7c136c054f/a022f/homepage-revenue-disbursements.jpg 786w\", \"/static/8216b1a577b24311b6712b7c136c054f/4450c/homepage-revenue-disbursements.jpg 1002w\"],\n    \"sizes\": \"(max-width: 786px) 100vw, 786px\",\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Our three \\u201Cinnovation specialists\\u201D (design and development team members) are limited to four years in each of our respective positions, so one of our biggest priorities over that time is to create a sustainable workflow for content management on the site. Transforming our data-update workflow is a significant step in that direction, but one of the other advantages of Gatsby is its ability to pull in data from virtually any source, including databases and content management systems. The site will always need some level of developer support, but Gatsby\\u2019s flexible architecture means we can start to look toward content management workflows that are practical for members of our extended team.\"), mdx(\"h3\", {\n    \"id\": \"modularity\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#modularity\",\n    \"aria-label\": \"modularity permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Modularity\"), mdx(\"p\", null, \"Perhaps React\\u2019s rising popularity is due to its modularity in the form of React components. Our site features repeating instances of similar or identical patterns, so Gatsby\\u2019s use of React was attractive to our team.\"), mdx(\"p\", null, \"For example, the homepage\\u2019s \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"KeyStatsSection\"), \" component references the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"StackedBarChartLayout\"), \" component, passing it props:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"return (\\n  <div is=\\\"chart\\\">\\n    <StackedBarChartLayout\\n      dataSet={this.state[dataSetId]}\\n      title={title}\\n      styleMap={CHART_STYLE_MAP}\\n      sortOrder={CHART_SORT_ORDER}\\n      legendTitle={CHART_LEGEND_TITLE}\\n      legendDataFormatFunc={dataFormatFunc || utils.formatToCommaInt}\\n      barSelectedCallback={this.dataKeySelectedHandler.bind(\\n        this,\\n        dataSetId,\\n        this.state[dataSetId].syncId\\n      )}\\n    />\\n  </div>\\n)\\n\")), mdx(\"h4\", {\n    \"id\": \"pattern-library\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#pattern-library\",\n    \"aria-label\": \"pattern library permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Pattern library\"), mdx(\"p\", null, \"This component architecture also feeds our pattern library (not yet live), so when we build or change a component, our pattern library will update itself. We will then have a working inventory of our components to reference for new feature development.\"), mdx(\"h4\", {\n    \"id\": \"css-modules\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#css-modules\",\n    \"aria-label\": \"css modules permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"CSS Modules\"), mdx(\"p\", null, \"With our homepage rebuild, we also started using \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/css-modules/css-modules\"\n  }), \"CSS Modules\"), \". CSS Modules are CSS files \\u201Cin which all class names and animation names are scoped locally by default,\\u201D and they\\u2019re a great way to avoid selector name collisions and limit the accumulation of unused styles.\"), mdx(\"p\", null, \"Scoping and storing each component\\u2019s CSS locally makes it much easier to track down and edit a component\\u2019s styling.\"), mdx(\"h3\", {\n    \"id\": \"a-modern-framework\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#a-modern-framework\",\n    \"aria-label\": \"a modern framework permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"A modern framework\"), mdx(\"p\", null, \"Nothing is future-proof in technology, but migrating to Gatsby gets us closer, with a flexible, modular architecture and a growing and spirited community of developers behind it. By migrating to Gatsby, we\\u2019re trying to build a maintainable, future-friendly codebase for the team that comes after us.\"), mdx(\"h2\", {\n    \"id\": \"challenges-during-rebuild\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#challenges-during-rebuild\",\n    \"aria-label\": \"challenges during rebuild permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Challenges during rebuild\"), mdx(\"p\", null, \"While our experience refactoring the homepage was largely positive, we have faced some challenges migrating to Gatsby. Some of those challenges are inherent in refactoring, caused by maintaining two codebases and build processes simultaneously. Others are perhaps due to the relatively new emergence of Gatsby itself, which is actively being worked on and upgraded.\"), mdx(\"p\", null, \"Here are the main challenges we\\u2019ve faced.\"), mdx(\"h3\", {\n    \"id\": \"long-build-times\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#long-build-times\",\n    \"aria-label\": \"long build times permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Long build times\"), mdx(\"p\", null, \"The site has parallel builds right now, compiling both the Gatsby and remaining Jekyll parts of the site. Build times can reach 20 minutes, much of which time is consumed by building the GraphQL schema. This can slow down our design and development workflow, and occasionally results in build time-outs on the otherwise excellent Federalist.\"), mdx(\"p\", null, \"We expect we can optimize our code to mitigate our long build times, and having only one build process will help. But we are asking a lot of GraphQL, and we understand the build time is associated with the complexity of our query schema.\"), mdx(\"h3\", {\n    \"id\": \"redundancies\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#redundancies\",\n    \"aria-label\": \"redundancies permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Redundancies\"), mdx(\"p\", null, \"Refactoring the site over time means we often have to manage content in two places. For instance, if we update content in the Jekyll part of the site, but we also have a Gatsby version in the pipeline, we need to update that, too.\"), mdx(\"p\", null, \"In some cases, we\\u2019ve delayed content updates or restyling, acknowledging it makes more sense to do so after the migration of that page or asset.\"), mdx(\"p\", null, \"Thankfully, we have strong communication on our team, and we work in the open, which helps us avoid more extreme problems with redundancy.\"), mdx(\"h3\", {\n    \"id\": \"integrating-with-jekyll\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h3\"\n  }, {\n    \"href\": \"#integrating-with-jekyll\",\n    \"aria-label\": \"integrating with jekyll permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Integrating with Jekyll\"), mdx(\"p\", null, \"Related to redundancy, providing a seamless user experience between the Gatsby and Jekyll portions of the site has been a challenge. There were three issues to resolve:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Page URL issue\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Gatsby prefetch error\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Federalist preview URL\")), mdx(\"h4\", {\n    \"id\": \"page-url-issue\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#page-url-issue\",\n    \"aria-label\": \"page url issue permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Page URL issue\"), mdx(\"p\", null, \"When Gatsby builds the site, it creates a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"public\"), \" directory for all required site assets. We copied this directory to a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-public\"), \" folder for the Jekyll build to use. However, we didn\\u2019t want our URLs to include \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-public\"), \", so we needed to add a permalink attribute to our pages\\u2019 front matter to override the default path.\"), mdx(\"p\", null, \"Fortunately, Gatsby provides a hook into the entire lifecycle of its build process, including an \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/docs/node-apis/#onPostBuild\"\n  }), mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"onPostBuild\"), \" API\"), \". We use this hook to add the front matter to our pages and copy the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"public\"), \" directory to the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-public\"), \" directory.\"), mdx(\"h4\", {\n    \"id\": \"gatsby-prefetch-error\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#gatsby-prefetch-error\",\n    \"aria-label\": \"gatsby prefetch error permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Gatsby prefetch error\"), mdx(\"p\", null, \"Developers tout Gatsby\\u2019s speed, and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/docs/how-code-splitting-works/\"\n  }), \"prefetching\"), \" page assets is integral to Gatsby\\u2019s performance advantages. However, Gatsby isn\\u2019t aware of our deployment structure, which results in an error when a page loads in the production environment.\"), mdx(\"p\", null, \"Basically, the Jekyll part of the site deploys to a directory that isn\\u2019t known to Gatsby at build time. Consequently, Gatsby creates a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pages.json\"), \" object that contains the wrong locations for files. To deal with this, we use another feature of Gatsby\\u2019s client API, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/docs/browser-apis/#onClientEntry\"\n  }), mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"onClientEntry\")), \". Using \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-browser.js\"), \", we override \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pages.json\"), \" by passing the correct assets to Gatsby (\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/ONRR/doi-extractives-data/blob/dev/gatsby-site/gatsby-browser.js\"\n  }), \"full code here\"), \".)\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"exports.onClientEntry = () => {\\n  // Patch the resource loader\\n  const loader = global.___loader\\n  if (!loader) return\\n\\n  let path = window.location.pathname\\n\\n  if (path.includes(\\\"/explore\\\") && usStateIds.includes(statePathId)) {\\n    loader.addPagesArray([\\n      {\\n        componentChunkName: \\\"component---src-templates-state-page-js\\\",\\n        layout: \\\"layout---index\\\",\\n        layoutComponentChunkName: \\\"component---src-layouts-index-js\\\",\\n        jsonName: \\\"explore-\\\" + statePathId.toLowerCase() + \\\".json\\\",\\n        path: path,\\n      },\\n    ])\\n  }\\n}\\n\")), mdx(\"h4\", {\n    \"id\": \"federalist-preview-url\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h4\"\n  }, {\n    \"href\": \"#federalist-preview-url\",\n    \"aria-label\": \"federalist preview url permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Federalist preview URL\"), mdx(\"p\", null, \"As mentioned above, we use \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://federalist.18f.gov/\"\n  }), \"Federalist\"), \" to build and deploy the site. Federalist builds out every branch in our GitHub repository, so we can preview the changes before we merge them.\"), mdx(\"p\", null, \"We encountered an issue with the Federalist preview URLs and relative links and assets. Gatsby solves this by using a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"pathPrefix\"), \" variable in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-config.js\"), \" and a custom component named \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"Link\"), \".\"), mdx(\"p\", null, \"We set a \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"BASEURL\"), \" environment variable in \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"gatsby-config.js\"), \" that resolves the Federalist preview URL at build time.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// Federalist provides the BASEURL env variable for preview builds.\\n// https://github.com/18F/federalist-garden-build#variables-exposed-during-builds\\nconst BASEURL = process.env.BASEURL || \\\"\\\"\\n\\nmodule.exports = {\\n  // This is currently the relative path in our Jekyll deployment. This path points to our Gatsby pages.\\n  // This prefix is prepended to load all our related images, code, and pages.\\n  pathPrefix: `${BASEURL}/gatsby-public`,\\n}\\n\")), mdx(\"h2\", {\n    \"id\": \"the-work-continues\"\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#the-work-continues\",\n    \"aria-label\": \"the work continues permalink\",\n    \"className\": \"anchor\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"The work continues\"), mdx(\"p\", null, \"We\\u2019ll continue to share our experience migrating Natural Resources Revenue Data to Gatsby. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/ONRR/doi-extractives-data\"\n  }), \"Track us down on GitHub\"), \" if you have questions or comments about our homepage or our transition to Gatsby.\"));\n}\n;\nMDXContent.isMDXComponent = true;",
        "excerpt": "This post was originally published at  Open data design at the U.S. Department of the Interior . A few months ago, our small team at the…",
        "timeToRead": 8,
        "fields": {
          "slug": "/blog/2019-02-08-government-open-data-site-with-gatsby/",
          "publishedAt": "revenuedata.doi.gov"
        },
        "frontmatter": {
          "title": "How we're migrating a government open data site to Gatsby",
          "excerpt": null,
          "date": "February 8th 2019",
          "rawDate": "2019-02-08T00:00:00.000Z",
          "canonicalLink": "https://revenuedata.doi.gov/blog/homepage-revamp-part-two/",
          "tags": [
            "cutting-edge-experiences",
            "data-visualization",
            "case-studies"
          ],
          "image": null,
          "imageAuthor": null,
          "imageAuthorLink": null,
          "imageTitle": null,
          "showImageInArticle": null,
          "author": {
            "id": "Ryan Johnson",
            "bio": "Content strategist at the U.S. Department of the Interior",
            "twitter": null,
            "avatar": {
              "childImageSharp": {
                "fixed": {
                  "tracedSVG": "data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='32'%20height='32'%3e%3crect%20width='100%25'%20height='100%25'%20fill='%23f6f2f8'/%3e%3cpath%20d='M29%209c0%208%200%2010%201%209l1%202-1%205c0%202%200%202-1%200v1c0%206%201%207%202%205%202-2%201-30-1-31l-1%209M13%204c-1%201-1%201%201%201%203%200%204%202%201%203-2%200-2%201-1%201%201%202%200%204-2%203l1%203c1%204%202%204%204%200%203-7%200-14-4-11m6%2023l-1%202-1%201-2%201h8l-1-2v-2h-3'%20fill='%23e0d6eb'%20fill-rule='evenodd'/%3e%3c/svg%3e",
                  "width": 64,
                  "height": 64,
                  "src": "/static/72cb46494b2f0e644b141a7feac60c61/88ae8/ryan-johnson.jpg",
                  "srcSet": "/static/72cb46494b2f0e644b141a7feac60c61/88ae8/ryan-johnson.jpg 1x,\n/static/72cb46494b2f0e644b141a7feac60c61/0740f/ryan-johnson.jpg 1.5x,\n/static/72cb46494b2f0e644b141a7feac60c61/c9264/ryan-johnson.jpg 2x"
                }
              }
            },
            "fields": {
              "slug": "/contributors/ryan-johnson/"
            }
          }
        }
      }
    },
    "pageContext": {
      "isCreatedByStatefulCreatePages": false,
      "slug": "/blog/2019-02-08-government-open-data-site-with-gatsby/",
      "prev": {
        "fields": {
          "slug": "/blog/2019-01-29-gatsby-eng-hiring-philosophy/",
          "package": null,
          "released": true
        },
        "frontmatter": {
          "title": "Gatsby Inc's Product & Engineering Hiring Philosophy",
          "draft": null,
          "canonicalLink": null,
          "publishedAt": null,
          "issue": null,
          "tags": [
            "gatsby-inc"
          ]
        }
      },
      "next": {
        "fields": {
          "slug": "/blog/2019-02-11-gatsby-themes-livestream-and-example/",
          "package": null,
          "released": true
        },
        "frontmatter": {
          "title": "Gatsby Themes: Watch Us Build a Theme Live\n",
          "draft": null,
          "canonicalLink": null,
          "publishedAt": null,
          "issue": null,
          "tags": [
            "themes",
            "livestream",
            "getting-started"
          ]
        }
      }
    }
  },
  "query": "query usersMisiekDevGatsbyWwwSrcTemplatesTemplateBlogPostJs2991924798(\n  $slug: String!\n) {\n  mdx(fields: {slug: {eq: $slug}}) {\n    body\n    excerpt\n    timeToRead\n    fields {\n      slug\n      publishedAt\n    }\n    frontmatter {\n      title\n      excerpt\n      date(formatString: \"MMMM Do YYYY\")\n      rawDate: date\n      canonicalLink\n      tags\n      image {\n        childImageSharp {\n          resize(width: 1500, height: 1500) {\n            src\n          }\n          fluid(maxWidth: 786) {\n            ...GatsbyImageSharpFluid\n          }\n        }\n      }\n      imageAuthor\n      imageAuthorLink\n      imageTitle\n      showImageInArticle\n      author {\n        id\n        bio\n        twitter\n        avatar {\n          childImageSharp {\n            fixed(width: 64, height: 64, quality: 75, traceSVG: {turdSize: 10, background: \"#f6f2f8\", color: \"#e0d6eb\"}) {\n              ...GatsbyImageSharpFixed_tracedSVG\n            }\n          }\n        }\n        fields {\n          slug\n        }\n      }\n    }\n  }\n}\n\nfragment GatsbyImageSharpFluid on ImageSharpFluid {\n  base64\n  aspectRatio\n  src\n  srcSet\n  sizes\n}\n\nfragment GatsbyImageSharpFixed_tracedSVG on ImageSharpFixed {\n  tracedSVG\n  width\n  height\n  src\n  srcSet\n}\n"
}